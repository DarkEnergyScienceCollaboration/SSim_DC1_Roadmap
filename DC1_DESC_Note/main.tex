% 
% ======================================================================
\RequirePackage{docswitch}
% \flag is set by the user, through the makefile:
%    make note
%    make apj
% etc.
\setjournal{\flag}

\documentclass[\docopts]{\docclass}

% You could also define the document class directly
%\documentclass[]{emulateapj}

% Custom commands from LSST DESC, see texmf/styles/lsstdesc_macros.sty
\usepackage{lsstdesc_macros}

\usepackage{graphicx}
\graphicspath{{./}{./figures/}}
\bibliographystyle{apj}

% Add your own macros here:



% 
% ======================================================================

\begin{document}

\title{ The LSST DESC Data Challenge 1: Simulating data for the next generation of photometric redshift surveys }

\maketitlepre

\begin{abstract}

The success of future Stage IV dark energy surveys~\citep{2006astro.ph..9591A} relies in the ability to model and mitigate systematic uncertainties.
Realistic simulation offer a unique opportunity to study systematic uncertainties and test the processing and analysis pipelines
of ongoing and future experiments. Here we present a set of realistic simulations of $\sim 40$ sq.-deg. that try to mimic the depth
and characteristics of LSST 10-years coadd images in the $r$-band. We characterize our samples performing several astrometric and
photometric checks to assess the quality of the measurements and to enable the usage of these simulations for future studies. 

\end{abstract}

% Keywords are ignored in the LSST DESC Note style:
\dockeys{latex: templates, papers: awesome}

\maketitlepost

% ----------------------------------------------------------------------
% 

\section{Introduction}
\label{sec:intro}

The increase in statistical power from recent cosmological experiments makes the modeling, and mitigation of systematic uncertainties
key to extract the maximum performance and produce competitive analyses. More traditional in high energy particle physics~\citep{Brun:118715},
~\citep{2006JHEP...05..026S}, end-to-end simulations provide a unique framework to model systematics and streamline processing and analysis
pipelines given that we have complete information about the inputs and outputs. With the larger availability of computational resources this
approach has also been extended to photometric redshift galaxy surveys~\citep{2016MNRAS.457..786S,2016ApJ...817...25B} and a similar effort is undergoing in spectroscopic surveys such as DESI~\citep{2016arXiv161100036D}. For surveys like the LSST~\citep{2008arXiv0805.2366I} where the expected data volume is very large and where a highly stringent control of the systematic uncertainties is required, producing these kind of end-to-end simulations becomes necessary.

In this paper, we present the procedure to generate and process images that resemble the data that will be produced by LSST~\citep{2008arXiv0805.2366I} after 10 years of operation in $r$-band using state of the art tools. We also characterize the products of this process for future studies. These productsencompass single-visit and coadded calibrated exposures (i.e., flattened, background removed, etc) and source catalogs that add up to $\sim 225 TB$. They are the result of three different simulations: imSim dithered, imSim undithered, and PhoSim that will be introduced later.

This paper is structured as follows: In Section \secref{inputs} we describe the input catalog used for our simulations, in Section \secref{image_generation_pipeline} we introduce two different approaches to generate simulated images to resemble LSST data. In Section \secref{image_processing_pipeline} we present the procedure and tools used to perform calibration and source extraction on the simulated images. In Section \secref{catalogs} we describe the output catalogs produced by our pipelines. Finally, in Section \secref{conclusions} we present some concluding remarks.

% ----------------------------------------------------------------------
\section{Image generation: inputs}
\label{sec:inputs}

\textcolor{red}{Describe CatSim inputs and dithering}

\section{Image generation: pipeline}
\label{sec:image_generation_pipeline}
% ---------------------------------------------------------------------

The artificial generation of astronomical images is a very complex and computationally demanding process. In the recent years there is a big effort in the community in order to create software that allows more realistic and fast image generation~\citep{2016MNRAS.457..786S,2016ApJ...817...25B}. In our case, we use two different approaches: In one approach we use modeling of the input sources using \textsc{GalSim}~\citep{2015A&C....10..121R}. The other approach consists in running a full photon-shooting simulation using \textsc{PhoSim}~\citep{2015ApJS..218...14P}. The former has a big speed advantage but the latter fully traces each photon coming from the sources through the atmosphere and the instrument, increasing the level of realism. These two approaches allow us to focus on different systematic effects and science cases.
  
\subsection{The imSim pipeline}
\label{sec:imsim_pipeline}

\textcolor{red}{Describe imSim}
% ----------------------------------------------------------------------

\subsection{The PhoSim pipeline}
\label{sec:phosim_pipeline}

\textcolor{red}{Describe PhoSim}
% ----------------------------------------------------------------------

\section{Image processing pipeline}
\label{sec:image_processing_pipeline}


\textcolor{red}{Describe steps in DM stack and output schema.}
% ----------------------------------------------------------------------

\section{Output catalogs}
\label{sec:catalogs}

After being processed the catalogs are stored at NERSC. We generate pandas dataframes and three different databases for each one of the total coadd catalogs in order to be accessed by the collaborators and perform their own analyses. These catalogs contain 10.6 million objects covering an area of $\sim$ 43 deg$^{2}$.

\subsection{Astrometric checks}
\label{sec:astrometric_checks}

\subsection{Photometry checks}
\label{sec:photometry_checks}

\subsection{PSF checks}
\label{sec:psf_checks}

% ----------------------------------------------------------------------

\section{Conclusions}
\label{sec:conclusions}


% ----------------------------------------------------------------------

\subsection*{Acknowledgments}

Here is where you should add your specific acknowledgments, remembering that some standard thanks will be added via the \code{acknowledgments.tex} and \code{contributions.tex} files.

\input{acknowledgments}

\input{contributions}

%{\it Facilities:} \facility{LSST}

% Include both collaboration papers and external citations:
\bibliography{lsstdesc,main}

\end{document}
% ======================================================================
% 
